# Test script for new Profile page approach
Write-Host "üé¨ Testing New Profile Page Approach" -ForegroundColor Cyan
Write-Host "===================================" -ForegroundColor Cyan

Write-Host "`nNew approach features:" -ForegroundColor Yellow
Write-Host "‚Ä¢ Separate useEffects for profile and bookings" -ForegroundColor White
Write-Host "‚Ä¢ Force load bookings on component mount" -ForegroundColor White
Write-Host "‚Ä¢ Multiple fallback strategies" -ForegroundColor White
Write-Host "‚Ä¢ Better error handling" -ForegroundColor White

Write-Host "`n1. API Test:" -ForegroundColor Green
try {
    $response = Invoke-RestMethod -Uri "http://localhost:8080/api/tickets/test" -Method GET
    Write-Host "‚úÖ API working - $($response.object.Count) tickets" -ForegroundColor Green
    
    # Show sample data
    if ($response.object.Count -gt 0) {
        $sample = $response.object[0]
        Write-Host "Sample ticket:" -ForegroundColor Cyan
        Write-Host "  ID: $($sample.id)" -ForegroundColor White
        Write-Host "  Email: $($sample.customerEmail)" -ForegroundColor White
        Write-Host "  Movie: $($sample.movie.title)" -ForegroundColor White
        Write-Host "  Price: $($sample.totalPrice)ƒë" -ForegroundColor White
    }
} catch {
    Write-Host "‚ùå API error: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host "`n2. Testing Instructions:" -ForegroundColor Yellow
Write-Host "=======================" -ForegroundColor Yellow
Write-Host "1. Open http://localhost:5173/profile" -ForegroundColor White
Write-Host "2. Open Developer Tools (F12) ‚Üí Console" -ForegroundColor White
Write-Host "3. Look for these logs in order:" -ForegroundColor White
Write-Host "   üéØ [Profile] Loading user profile..." -ForegroundColor Gray
Write-Host "   üéØ [Profile] Force loading bookings on mount..." -ForegroundColor Gray
Write-Host "   üéØ [Profile] Force load - API response: [array]" -ForegroundColor Gray
Write-Host "   üéØ [Profile] Force load - filtered bookings: X" -ForegroundColor Gray
Write-Host "   üéØ [Profile] Rendering bookings section, bookings.length: X" -ForegroundColor Gray

Write-Host "`n3. Expected Behavior:" -ForegroundColor Cyan
Write-Host "=====================" -ForegroundColor Cyan
Write-Host "‚úÖ Bookings should load automatically within 500ms" -ForegroundColor Green
Write-Host "‚úÖ No need to click 'L√†m m·ªõi'" -ForegroundColor Green
Write-Host "‚úÖ Console should show multiple loading attempts" -ForegroundColor Green
Write-Host "‚úÖ If user logged in: shows filtered bookings" -ForegroundColor Green
Write-Host "‚úÖ If user not logged in: shows all bookings" -ForegroundColor Green

Write-Host "`n4. Debug Information:" -ForegroundColor Magenta
Write-Host "====================" -ForegroundColor Magenta
Write-Host "The new approach uses:" -ForegroundColor White
Write-Host "‚Ä¢ useEffect with empty deps [] - runs on mount" -ForegroundColor White
Write-Host "‚Ä¢ setTimeout 500ms delay - ensures everything loaded" -ForegroundColor White
Write-Host "‚Ä¢ Multiple loading strategies - increases success rate" -ForegroundColor White
Write-Host "‚Ä¢ Better logging - easier to debug" -ForegroundColor White

Write-Host "`n5. If Still Not Working:" -ForegroundColor Red
Write-Host "=========================" -ForegroundColor Red
Write-Host "Check console for:" -ForegroundColor White
Write-Host "‚Ä¢ JavaScript errors" -ForegroundColor White
Write-Host "‚Ä¢ Network request failures" -ForegroundColor White
Write-Host "‚Ä¢ Authentication issues" -ForegroundColor White
Write-Host "‚Ä¢ API response format" -ForegroundColor White

Write-Host "`nReady to test the new approach!" -ForegroundColor Cyan
